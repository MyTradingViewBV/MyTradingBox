<div class="chart-container" 
     (dblclick)="onChartDblClick()" 
     (touchstart)="onTouchStart($event)"
     (touchmove)="onTouchMove($event)"
     (touchend)="onTouchEnd($event)"
     (mousedown)="onMouseDown($event)"
     (mousemove)="onMouseMove($event)"
     (mouseup)="onMouseUp($event)"
     (mouseleave)="onMouseUp($event)"
     (wheel)="onWheel($event)"
     [class.interacting]="isInteracting">
    
    <canvas baseChart 
            [data]="chartData" 
            [options]="chartOptions" 
            [type]="'candlestick'"
            #chartCanvas>
    </canvas>
    
    <!-- Gesture feedback (minimal, TradingView-style) -->
    <div class="interaction-overlay" 
         *ngIf="isInteracting && gestureType"
         [attr.data-gesture]="gestureType">
    </div>
    
    <!-- Control panel (mobile-friendly) -->
    <div class="chart-controls">
        <div class="zoom-group">
            <button class="control-btn zoom-in" 
                    (click)="zoomIn()" 
                    title="Zoom In (Scroll)"
                    [disabled]="!chartData.datasets?.[0]?.data?.length">
                <span>+</span>
            </button>
            <button class="control-btn zoom-out" 
                    (click)="zoomOut()" 
                    title="Zoom Out (Scroll)"
                    [disabled]="!chartData.datasets?.[0]?.data?.length">
                <span>−</span>
            </button>
        </div>
        
        <div class="action-group">
            <button class="control-btn fit-data" 
                    (click)="fitToData()" 
                    title="Fit All Data"
                    [disabled]="!chartData.datasets?.[0]?.data?.length">
                <span>⤢</span>
            </button>
            <button class="control-btn reset-zoom" 
                    (click)="resetZoom()" 
                    title="Reset to Default View"
                    [disabled]="!chartData.datasets?.[0]?.data?.length">
                <span>⌂</span>
            </button>
        </div>
    </div>
    
    <!-- Instructions overlay (hide after first interaction) -->
    <div class="instructions" 
         *ngIf="!isInteracting && chartData.datasets?.[0]?.data?.length">
        <div class="instruction-item">
            <span class="icon">👆</span>
            <span class="text">Drag to pan</span>
        </div>
        <div class="instruction-item">
            <span class="icon">🔍</span>
            <span class="text">Scroll to zoom</span>
        </div>
        <div class="instruction-item mobile-only">
            <span class="icon">🤏</span>
            <span class="text">Pinch to zoom</span>
        </div>
    </div>
</div>
